[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/iHSjCEgj)
# J05

本次作业已全部完成，这是一个修改后的 README.md

## 本次实验更新部分

1. 实现 LWJGL + OpenGL 纯 GPU 渲染。该部分完全参考仓库代码。额外的预加载内容未实现
2. 存档功能：部分参考仓库代码，以输入和事件为主，关键帧用于辅助
3. 回放功能：与仓库代码不同，大部分与 GameScene 一致，即根据记录的输入模拟游戏运行，不同处在于增加了根据关键帧保持一致性的部分
4. 部分重构过去代码

## 游戏逻辑说明

游戏逻辑同 j03

背景音乐组件仍然可用，只是在这部分暂时注释掉

## 更新内容说明

### graphics 更新

由于使用了构建工具，所以不需要脚本下载，直接编译即可

```cmd
mvn clean
mvn compile
mvn exec:java
```

### 存档功能

主要记录两部分内容

- 关键帧
  - 每隔一定时间记录当前 Scene 中所有 Enemy 的位置和速度
  - 只记录 Enemy 是因为回放的实现逻辑和仓库代码不同，不需要记录所有 Entity 就可以实现很好的效果
  - 对玩家，只需要记录血量和分数，便于在特殊情况下矫正 Replay 状态
- 玩家输入
  - 只记录键盘按键的按下和抬起，在这之间通过记录上次操作状态确定某个按键是否按下
  - 相比记录每一帧操作更加简洁，且效果不差
  - 记录输入而不是记录玩家的位置和速度，是因为这种方式在短时间多次不同操作下表现更好 (通过和仓库代码比较得到)

考虑到后续的联机功能需求，本次实验对复数玩家的情况做了一定兼容，但还有待完善

### 回放功能

和仓库代码完全不同，主要流程与 GameScene 几乎完全一致，区别在于输入的读入和敌人的生成

- Replay 的输入读入
  - 新建了 IInputManager 接口和 ReplayInputManager 类，将输入转换为 replay 模式下可以识别的输入
  - 通过记录每个操作的时间戳，replay 时只进行当前时间戳过去的操作，防止提前操作
- 敌人生成
  - 不再随机生成，而是根据关键帧记录生成
  - 记录时，为每个敌人唯一标号，replay 时，将标号和新生成的敌人一一对应，根据时间戳矫正每个敌人的位置，速度，存活状态
  - 实际运行后发现不需要对位置和速度矫正表现依旧良好
